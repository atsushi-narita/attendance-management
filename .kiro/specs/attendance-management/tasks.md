# 勤怠管理ツール実装計画

## 実装タスク一覧

- [x] 1. プロジェクト基盤と CI/CD パイプラインの構築

  - AWS CodePipeline と CodeBuild プロジェクトの設定
  - GitHub リポジトリとの連携設定
  - 環境別パラメータファイルの作成
  - _要件: 全要件の基盤となるインフラ構築_

- [x] 1.1 AWS インフラストラクチャの定義

  - CloudFormation テンプレートの作成（Cognito、API Gateway、Lambda、RDS）
  - 環境別パラメータファイル（dev/staging/prod）の作成
  - IAM ロールとポリシーの定義
  - _要件: 1.1, 2.1, 3.1, 4.1, 5.1, 6.1_

- [x] 1.2 CI/CD パイプラインの実装

  - CodePipeline の設定とデプロイ
  - CodeBuild プロジェクトの作成（インフラ、バックエンド、フロントエンド）
  - GitHub ウェブフックの設定
  - _要件: 全要件の継続的デプロイメント_

- [x] 1.3 監視・アラート設定

  - CloudWatch アラームの設定
  - SNS 通知の設定
  - ログ監視の設定
  - _要件: システム運用の安定性_

- [x] 2. データベース設計と基盤実装

  - PostgreSQL スキーマの作成
  - DOMA マッパーインターフェースの実装
  - データベース接続設定
  - _要件: 1.2, 2.1, 3.1, 4.1, 5.1, 6.1_

- [x] 2.1 データベーススキーマの実装

  - employees、attendance_records、correction_requests テーブルの作成
  - インデックスと制約の設定
  - 初期データの投入スクリプト作成
  - _要件: 1.2, 2.1, 3.1, 4.1, 5.1, 6.1_

- [x] 2.2 DOMA マッパーの実装

  - AttendanceRecordDao、EmployeeDao、CorrectionRequestDao の作成
  - SQL 文の実装（SELECT、INSERT、UPDATE、DELETE）
  - トランザクション管理の設定
  - _要件: 1.1, 2.1, 3.1, 4.1, 5.1, 6.1_

- [x] 2.3 データベーステストの実装

  - TestContainers を使用した統合テスト
  - マッパーメソッドの単体テスト
  - データ整合性テスト
  - _要件: データの信頼性確保_

- [x] 3. AWS Cognito 認証システムの実装

  - Cognito User Pools と Identity Pools の設定
  - 役割ベースアクセス制御の実装
  - JWT 認証の実装
  - _要件: 3.1, 4.1_

- [x] 3.1 Cognito 設定とユーザー管理

  - User Pools の作成と設定
  - Cognito Groups の作成（employees、managers、admins）
  - カスタム属性の設定（employee_number、role）
  - _要件: 3.1, 4.1_

- [x] 3.2 Lambda 認証機能の実装

  - JWT トークン検証機能
  - ユーザー権限チェック機能
  - セッション管理機能
  - _要件: 3.1, 4.1_

- [x] 3.3 認証テストの実装

  - JWT トークン検証テスト
  - 権限チェックテスト
  - セッション管理テスト
  - _要件: セキュリティの確保_

- [x] 4. バックエンド API（Lambda 関数）の実装

  - 打刻機能の Lambda 関数実装
  - 勤務記録取得の Lambda 関数実装
  - 従業員管理の Lambda 関数実装
  - 修正申請の Lambda 関数実装
  - _要件: 1.1, 1.2, 1.3, 1.4, 2.1, 2.2, 2.3, 3.1, 3.2, 3.3, 4.1, 4.2, 4.3, 4.4, 5.1, 5.2, 5.3, 5.4, 5.5, 6.1, 6.2, 6.3_

- [x] 4.1 打刻機能 Lambda 関数の実装

  - AttendanceHandler クラスの作成
  - 出勤打刻 API（POST /api/attendance/clock-in）
  - 退勤打刻 API（POST /api/attendance/clock-out）
  - 打刻状態取得 API（GET /api/attendance/status）
  - _要件: 1.1, 1.2, 1.3, 1.4_

- [x] 4.2 勤務記録管理 Lambda 関数の実装

  - RecordHandler クラスの作成
  - 勤務記録一覧取得 API（GET /api/records）
  - 従業員別勤務記録取得 API（GET /api/records/{employeeId}）
  - 月別勤務時間サマリー API（GET /api/records/{employeeId}/summary）
  - _要件: 2.1, 2.2, 2.3_

- [x] 4.3 従業員管理 Lambda 関数の実装

  - EmployeeHandler クラスの作成
  - 従業員一覧取得 API（GET /api/employees）
  - 従業員登録 API（POST /api/employees）
  - 従業員更新 API（PUT /api/employees/{id}）
  - 従業員削除 API（DELETE /api/employees/{id}）
  - _要件: 4.1, 4.2, 4.3, 4.4_

- [x] 4.4 修正申請 Lambda 関数の実装

  - CorrectionHandler クラスの作成
  - 修正申請提出 API（POST /api/corrections）
  - 修正申請一覧取得 API（GET /api/corrections）
  - 修正申請承認 API（PUT /api/corrections/{id}/approve）
  - 修正申請却下 API（PUT /api/corrections/{id}/reject）
  - _要件: 6.1, 6.2, 6.3_

- [x] 4.5 勤務時間計算ロジックの実装

  - WorkingHoursCalculationService クラスの作成
  - 日別勤務時間計算機能
  - 月別勤務時間集計機能
  - 規定拘束時間過不足計算機能
  - _要件: 2.2, 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 4.6 バックエンド API テストの実装

  - Lambda 関数の単体テスト
  - API 統合テスト
  - エラーハンドリングテスト
  - _要件: API の信頼性確保_

- [x] 5. フロントエンド基盤の構築

  - Nuxt.js プロジェクトの初期設定
  - Apple HIG 準拠のデザインシステム構築
  - 日本語国際化設定
  - AWS Amplify 認証統合
  - _要件: 全要件の UI 基盤_

- [x] 5.1 Nuxt.js プロジェクトセットアップ

  - プロジェクト初期化とディレクトリ構造作成
  - 必要なパッケージのインストール（Pinia、i18n、Amplify 等）
  - 基本設定ファイルの作成（nuxt.config.ts、tsconfig.json 等）
  - _要件: フロントエンド開発基盤_

- [x] 5.2 デザインシステムと UI コンポーネントの実装

  - Apple HIG 準拠のカラーパレットとタイポグラフィ設定
  - 基本 UI コンポーネント（Button、Input、Card 等）の作成
  - レスポンシブデザインとアクセシビリティ対応
  - _要件: 使いやすい UI 提供_

- [x] 5.3 国際化（i18n）設定と日本語対応

  - Vue i18n プラグインの設定
  - 日本語言語ファイルの作成
  - 日付・時刻・数値フォーマットの日本語対応
  - _要件: 日本語 UI 提供_

- [x] 5.4 AWS Amplify 認証統合

  - Amplify 設定と Cognito 連携
  - 認証状態管理（Pinia store）
  - 認証ガードとルート保護
  - _要件: 3.1, 4.1_

- [x] 5.5 フロントエンド基盤テスト

  - コンポーネント単体テスト
  - 認証フローテスト
  - 国際化機能テスト
  - _要件: フロントエンド品質確保_

- [x] 6. 打刻機能画面の実装

  - 打刻カードコンポーネントの作成
  - 打刻状態表示機能
  - 出勤・退勤ボタン機能
  - リアルタイム時刻表示
  - _要件: 1.1, 1.2, 1.3, 1.4_

- [x] 6.1 打刻画面（AttendanceCard）の実装

  - 現在時刻とステータス表示
  - 出勤・退勤ボタンの実装
  - 打刻確認ダイアログ
  - 勤務時間のリアルタイム表示
  - _要件: 1.1, 1.2, 1.3, 1.4_

- [x] 6.2 打刻 API 連携の実装

  - useAttendance composable の作成
  - API 呼び出しとエラーハンドリング
  - 打刻状態の管理（Pinia store）
  - _要件: 1.1, 1.2, 1.3, 1.4_

- [x] 6.3 打刻機能テスト

  - 打刻コンポーネントテスト
  - API 連携テスト
  - エラーケーステスト
  - _要件: 打刻機能の信頼性_

- [x] 7. 勤務記録確認画面の実装

  - 勤務記録テーブルコンポーネント
  - 月別サマリー表示
  - 規定拘束時間過不足表示
  - フィルター・検索機能
  - _要件: 2.1, 2.2, 2.3, 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 7.1 勤務記録一覧画面の実装

  - RecordTable コンポーネントの作成
  - 日別勤務記録の表示
  - ページネーション機能
  - ソート機能
  - _要件: 2.1, 2.2, 2.3_

- [x] 7.2 勤務時間サマリー画面の実装

  - WorkingHoursSummary コンポーネントの作成
  - 月別勤務時間集計表示
  - 規定拘束時間との比較表示
  - 過不足時間の視覚的表示
  - _要件: 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 7.3 勤務記録 API 連携の実装

  - useRecords composable の作成
  - 記録取得とフィルタリング機能
  - データキャッシュとリアルタイム更新
  - _要件: 2.1, 2.2, 2.3, 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 7.4 勤務記録画面テスト

  - 記録表示コンポーネントテスト
  - サマリー計算テスト
  - フィルター機能テスト
  - _要件: 記録表示機能の正確性_

- [x] 8. 従業員管理画面の実装（管理者用）

  - 従業員一覧表示
  - 従業員登録・編集フォーム
  - 従業員削除機能
  - 権限管理
  - _要件: 4.1, 4.2, 4.3, 4.4_

- [x] 8.1 従業員一覧画面の実装

  - 従業員リストコンポーネント
  - 検索・フィルター機能
  - ソート機能
  - 一括操作機能
  - _要件: 4.1, 4.4_

- [x] 8.2 従業員登録・編集フォームの実装

  - EmployeeForm コンポーネントの作成
  - バリデーション機能
  - 規定拘束時間設定（140-180 時間）
  - 役職・権限設定
  - _要件: 4.1, 4.2, 4.3_

- [x] 8.3 従業員管理 API 連携の実装

  - useEmployees composable の作成
  - CRUD 操作の実装
  - 権限チェック機能
  - _要件: 4.1, 4.2, 4.3, 4.4_

- [x] 8.4 従業員管理画面テスト

  - フォームバリデーションテスト
  - CRUD 操作テスト
  - 権限制御テスト
  - _要件: 従業員管理機能の信頼性_

- [x] 9. 修正申請機能の実装

  - 修正申請フォーム
  - 申請一覧表示
  - 承認・却下機能（管理者用）
  - 修正履歴表示
  - _要件: 6.1, 6.2, 6.3_

- [x] 9.1 修正申請フォームの実装

  - CorrectionRequestForm コンポーネント
  - 対象日・時刻選択機能
  - 修正理由入力
  - 申請確認機能
  - _要件: 6.1_

- [x] 9.2 修正申請一覧・承認画面の実装

  - 申請一覧表示コンポーネント
  - 承認・却下ボタン機能
  - 申請詳細表示
  - 処理履歴表示
  - _要件: 6.2, 6.3_

- [x] 9.3 修正申請 API 連携の実装

  - useCorrections composable の作成
  - 申請提出・承認・却下機能
  - 申請状態管理
  - _要件: 6.1, 6.2, 6.3_

- [x] 9.4 修正申請機能テスト

  - 申請フォームテスト
  - 承認フローテスト
  - 権限制御テスト
  - _要件: 修正申請機能の正確性_

- [x] 10. ダッシュボード画面の実装

  - 今日の勤怠状況表示
  - 月間サマリー表示
  - 要対応項目表示
  - クイックアクション機能
  - _要件: 全要件の統合表示_

- [x] 10.1 ダッシュボードメイン画面の実装

  - 今日の勤怠カード表示
  - 月間統計サマリー
  - 最近の活動履歴
  - _要件: 2.1, 2.2, 5.1, 5.2, 5.3, 5.4, 5.5_

- [x] 10.2 管理者ダッシュボードの実装

  - 全従業員の勤怠状況
  - 承認待ち申請一覧
  - システム統計情報
  - _要件: 3.1, 3.2, 3.3, 6.2_

- [x] 10.3 ダッシュボード機能テスト

  - データ集計テスト
  - リアルタイム更新テスト
  - 権限別表示テスト
  - _要件: ダッシュボード機能の正確性_

- [x] 11. 最終統合とデプロイメント

  - 全機能の統合テスト
  - パフォーマンス最適化
  - セキュリティ検証
  - 本番環境デプロイ
  - _要件: 全要件の統合と品質確保_

- [x] 11.1 統合テストとバグ修正

  - エンドツーエンドテスト実行
  - クロスブラウザテスト
  - モバイル対応テスト
  - 発見されたバグの修正
  - _要件: 全要件の品質確保_

- [x] 11.2 パフォーマンス最適化

  - フロントエンドバンドル最適化
  - Lambda 関数のコールドスタート対策
  - データベースクエリ最適化
  - CDN 設定とキャッシュ戦略
  - _要件: システムパフォーマンス向上_

- [x] 11.3 セキュリティ検証と本番デプロイ

  - セキュリティスキャン実行
  - 脆弱性対策の確認
  - 本番環境への段階的デプロイ
  - 監視・アラート設定の確認
  - _要件: セキュアな本番運用_
